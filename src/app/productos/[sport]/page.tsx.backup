'use client';
import React, { useState, useCallback, useMemo } from 'react';
import { useParams } from 'next/navigation';
import Image from 'next/image';

export default function ProductsPage() {
  const params = useParams();
  const sport = decodeURIComponent(params.sport as string);
  const [displayCount, setDisplayCount] = useState(12);
  const [imageErrors, setImageErrors] = useState(new Set());

  // Get all 75 soccer jerseys
  const getAllSoccerProducts = () => {
    const soccerJerseys = [
      '2.png', 'A.png', 'AS.png', 'ASD.png', 'ASDF.png', 'ASDFG.png', 'ASDFGH.png',
      'B.png', 'Bl.png', 'Blu.png', 'Blue S.png', 'Blue So.png', 'Blue Soc.png',
      'Blue Socc.png', 'Blue Socce.png', 'Blue Soccer J.png', 'Blue Soccer Je.png',
      'Blue Soccer Jer.png', 'Blue Soccer Jers.png', 'Blue Soccer Jerse.png',
      'Blue Soccer Jersey F.png', 'Blue Soccer Jersey Fl.png', 'Blue Soccer Jersey Fla.png',
      'Blue Soccer Jersey Flat Lay.png', 'Blue Soccer Jersey Flat.png', 'Blue Soccer Jersey.png',
      'Blue Soccer.png', 'Blue.png', 'MYSTIQUE.png', 'NEWSFLASHHOES.png', 'Q.png',
      'QW.png', 'QWE.png', 'QWER.png', 'QWERTY.png', 'QWERTYU.png', 'Z.png',
      'bluesocc.png', 'qqq.png', 'qqq1.png', 'qqq12.png', 'qqq123.png', 'qqq1234.png',
      'qqq12345.png', 'qqq123456.png', 'qqq1234561.png', 'qqq12345612.png', 'qqq123456123.png',
      'qqq1234561234.png', 'qqq12345612345.png', 'qqq123456123456.png', 'za.png', 'zaq.png',
      'zaqw.png', 'zaqws.png', 'zaqwsd.png', 'zaqwsde.png', 'zaqwsdfer.png', 'zaqwsx.png',
      'zasdxcfvg.png', 'zasertedcf.png', 'zasqwsx.png', 'zasxdc.png', 'zasxderft.png',
      'zasxdfgh.png', 'zx.png', 'zxc.png', 'zxcv.png', 'zxcvb.png', 'zxcvbn.png',
      'zxcvbnm.png', 'zxcvc.png', 'zxcx.png', 'zxcxz.png', 'zxz.png'
    ];

    return soccerJerseys.map((filename, index) => ({
      id: index + 1,
      name: `Camiseta de F√∫tbol ${filename.replace('.png', '').replace(/\s+/g, ' ')}`,
      price: `$${(42 + Math.floor(Math.random() * 15)).toLocaleString()}.000`,
      image: `/Products/Soccer/Jerseys/${filename}`
    }));
  };

  // All products for each sport
  const allProducts = {
    'f√∫tbol': getAllSoccerProducts(),
    'b√°squetbol': (() => {
      const basketballImages = [
        'beautyblu.png', 'blaccc.png', 'black mamba.png', 'breakthrough.png',
        'brownnn.png', 'cool purplll.png', 'dunnos.png', 'dye.png',
        'elevate 2.png', 'elevate 3.png', 'elevate 5.png', 'jaggered.png',
        'laker sky.png', 'lines.png', 'miamiii.png', 'miayay.png',
        'mounts.png', 'nest.png', 'phildo.png', 'reddd.png',
        'usa.png', 'wave rangee.png', 'wuha.png', 'yelblu.png'
      ];
      return basketballImages.map((filename, index) => ({
        id: index + 1,
        name: `Jersey de B√°squetbol ${filename.replace('.png', '').replace(/\s+/g, ' ')}`,
        price: `$${(45 + Math.floor(Math.random() * 20)).toLocaleString()}.000`,
        image: `/Products/Basketball/${filename}`
      }));
    })(),
    'voleibol': Array.from({length: 15}, (_, i) => ({
      id: i + 1,
      name: `Uniforme de Voleibol ${i + 1}`,
      price: `$${(40 + Math.floor(Math.random() * 15)).toLocaleString()}.000`,
      image: '/placeholder-product.jpg'
    })),
    'rugby': Array.from({length: 12}, (_, i) => ({
      id: i + 1,
      name: `Jersey de Rugby ${i + 1}`,
      price: `$${(50 + Math.floor(Math.random() * 20)).toLocaleString()}.000`,
      image: '/placeholder-product.jpg'
    })),
    'golf': Array.from({length: 10}, (_, i) => ({
      id: i + 1,
      name: `Polo de Golf ${i + 1}`,
      price: `$${(45 + Math.floor(Math.random() * 25)).toLocaleString()}.000`,
      image: '/placeholder-product.jpg'
    })),
    'equipo': Array.from({length: 8}, (_, i) => ({
      id: i + 1,
      name: `Uniforme de Equipo ${i + 1}`,
      price: `$${(55 + Math.floor(Math.random() * 30)).toLocaleString()}.000`,
      image: '/placeholder-product.jpg'
    }))
  };

  const allProductsForSport = useMemo(() => allProducts[sport] || [], [sport]);
  const products = useMemo(() => allProductsForSport.slice(0, displayCount), [allProductsForSport, displayCount]);
  const hasMore = displayCount < allProductsForSport.length;
  const sportName = sport?.charAt(0).toUpperCase() + sport?.slice(1) || '';

  const loadMore = useCallback(() => {
    setDisplayCount(prev => Math.min(prev + 12, allProductsForSport.length));
  }, [allProductsForSport.length]);

  const handleImageError = useCallback((productId) => {
    setImageErrors(prev => new Set([...prev, productId]));
  }, []);

  return (
    <div className="w-full min-h-screen bg-white">
      <div className="flex items-start justify-center pt-16">
        <div className="max-w-7xl mx-auto px-4 w-full">
          {/* Header */}
          <div className="text-center mb-12">
            <h1 className="text-2xl md:text-3xl lg:text-4xl font-black text-black mb-4 leading-tight font-montserrat">
              <span className="text-[#e21c21]">PRODUCTOS DE</span>{' '}
              <span className="text-black">{sportName.toUpperCase()}</span>
            </h1>
            <p className="text-base md:text-lg text-gray-700 leading-relaxed font-montserrat">
              Explora nuestra colecci√≥n completa de uniformes profesionales
            </p>

            {/* Back to Home Button */}
            <div className="mt-6">
              <button
                onClick={() => window.location.href = '/'}
                className="text-gray-600 hover:text-[#e21c21] transition-colors duration-300 font-montserrat"
              >
                ‚Üê Volver al inicio
              </button>
            </div>
          </div>

          {/* Products Grid */}
          <div className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-6">
            {products.map((product) => (
              <div
                key={product.id}
                className="bg-white border-2 border-gray-200 rounded-xl p-4 hover:border-red-500 hover:shadow-lg transition-all duration-300 transform hover:-translate-y-1 group"
              >
                {/* Product Image */}
                <div className="aspect-square bg-gray-100 rounded-lg mb-3 overflow-hidden relative">
                  {sport === 'f√∫tbol' || sport === 'b√°squetbol' ? (
                    imageErrors.has(product.id) ? (
                      <div className="w-full h-full flex items-center justify-center">
                        <div className="text-3xl text-gray-400">üì∏</div>
                      </div>
                    ) : (
                      <Image
                        src={product.image}
                        alt={product.name}
                        fill
                        className="object-cover"
                        sizes="(max-width: 640px) 50vw, (max-width: 768px) 33vw, (max-width: 1024px) 25vw, 20vw"
                        loading="lazy"
                        onError={() => handleImageError(product.id)}
                        placeholder="blur"
                        blurDataURL="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAABAAEDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAv/xAAhEAACAQMDBQAAAAAAAAAAAAABAgMABAUGIWGRkrHB0f/EABUBAQEAAAAAAAAAAAAAAAAAAAMF/8QAGhEAAgIDAAAAAAAAAAAAAAAAAAECEgMRkf/aAAwDAQACEQMRAD8AltJagyeH0AthI5xdrLcNM91BF5pX2HaH9bcfaSXWGaRmknyzsssssss/9k="
                      />
                    )
                  ) : (
                    <div className="w-full h-full flex items-center justify-center">
                      <div className="text-3xl text-gray-400">üì∏</div>
                    </div>
                  )}
                </div>

                {/* Product Info */}
                <div className="text-center space-y-2">
                  <h3 className="text-sm font-semibold text-gray-800 font-montserrat h-10 flex items-center justify-center text-center">
                    {product.name}
                  </h3>
                  <p className="text-lg font-black text-[#e21c21] font-montserrat">
                    {product.price}
                  </p>
                  <button className="w-full bg-[#e21c21] text-white py-2 px-4 rounded-xl font-semibold hover:bg-black transition-colors duration-300 text-sm font-montserrat">
                    Ver Producto
                  </button>
                </div>
              </div>
            ))}
          </div>

          {/* Load More Button */}
          {hasMore && (
            <div className="text-center mt-12 mb-8">
              <button
                onClick={loadMore}
                className="bg-[#e21c21] text-white px-8 py-3 rounded-xl font-semibold hover:bg-black transition-colors duration-300 font-montserrat shadow-lg hover:shadow-xl transform hover:scale-105"
              >
                Cargar M√°s Productos
              </button>
            </div>
          )}

          {/* Show count */}
          <div className="text-center mt-8 mb-8">
            <p className="text-gray-600 font-montserrat">
              Mostrando {products.length} de {allProductsForSport.length} productos de {sportName}
            </p>
          </div>
        </div>
      </div>
    </div>
  );
}